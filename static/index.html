<!doctype html>
<html class="no-js" lang="en">
  <head>
    <title>xls_sql</title>
    <script src="sql.js"></script>
    <script src="jquery-1.11.2.min.js"></script>
    <script src="handlebars-v2.0.0.js"></script>
    <script src="ember-1.9.1.js"></script>
    
    <link rel=stylesheet href="style.css" />
    <link rel=stylesheet href="normalize.css" />
    <link rel=stylesheet href="foundation.min.css" />
  </head>
  <body>


    <script type="text/x-handlebars" data-template-name="index" id="application">
      <div class="row" id="metadata">
        <div class="small-12 columns">
          <form id="fileform" {{action "uploadFileAction" on="submit" target="controller"}}>
            <input id="fileinput" type="file" name="file" {{action "fileSelectionChangedAction" on="change" target="controller"}}>
            {{#if hasFile}}
              <input class="button" type="submit" value="Upload!">
            {{/if}}
          </form>
        </div>
      </div>

      <div class="row" id="data">
        <div class="small-12 columns">
        {{#if data}}
          {{data-table data=data}}
        {{/if}}
        </div>
      </div>

      <div class="row" id="query">
        <div class="small-12 columns">
        {{#if data}}
          <h2>SQL query</h2>
          {{textarea valueBinding="query"}}
          <button {{action "runQueryAction" on="click" target="controller"}}>Run SQL</button>
        {{/if}}
        </div>
      </div>

      <div class="row" id="results">
        <div class="small-12 columns">
        {{#if results}}
          <h2>Results</h2>
          <ul>
          {{#each result in results}}
            <li>
              <span class='query'>{{result.query}}</span>
              {{#if result.data}}
                {{data-table data=result.data}}
              {{/if}}
              {{#if result.error}}
                <span class='error'>{{result.error}}</span>
              {{/if}}
            </li>
          {{/each}}
          </ul>
        {{/if}}
        </div>
      </div>
    </script>

    <script type="text/x-handlebars" id="components/data-table">
      <table class='datatable'>
        <thead>
          <tr>
            {{#each heading in headings}}
              <th>{{heading}}</th>
            {{/each}}
          </tr>
        </thead>
        <tbody>
          {{#each row in content}}
          <tr>
            {{#each cell in row}}
              <td>{{cell}}</td>
            {{/each}}
          </tr>
          {{/each}}
        </tbody>
      </table>
      <span class='numrows'>{{content.length}} rows</span>
    </script>

    <script src="app.js"></script>
  </body>
</html>
